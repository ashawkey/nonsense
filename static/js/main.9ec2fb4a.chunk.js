(this.webpackJsonpnonsense=this.webpackJsonpnonsense||[]).push([[0],{137:function(e,t,n){},210:function(e,t,n){e.exports=n(678)},215:function(e,t,n){},221:function(e,t,n){},224:function(e,t,n){},225:function(e,t,n){},226:function(e,t,n){},678:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),l=n(94),c=n.n(l),o=(n(215),n(28)),s=n(16),i=n(185),u=n.n(i),m=(n(137),n(186)),d=n.n(m);const f="https://www.kiui.moe/api/nonsense";n(221);function h(e){var t=new Date(1e3*e),n=t.getFullYear(),a=t.getMonth()+1,r=t.getDate(),l=t.getHours(),c=t.getMinutes();return n+"-"+a+"-"+r+" "+(l<=9?"0"+l:l)+":"+(c<=9?"0"+c:c)}function E(){return localStorage.nonsense_token||"nonsense"}function p(e){return r.a.createElement("div",{className:"flow-item"},r.a.createElement(o.b,{to:"/edit/"+e.value[0]},r.a.createElement("div",{className:"date"},r.a.createElement("span",null," ",function(e,t){var n="000000000"+e.toString();return n.substr(n.length-t)}(e.value[0],6)," "),r.a.createElement("span",null," "," "+h(e.value[2])," "),r.a.createElement("span",null," "," "+h(e.value[1])," ")),r.a.createElement("hr",null),r.a.createElement("div",{className:"content"},(t=e.value[3],n=300,t.length>n?t.substring(0,n)+"......":t))));var t,n}var b=function(e){return r.a.createElement("div",{className:"flow"},e.items.map((e,t)=>r.a.createElement(p,{value:e,key:t})))};var v=function(){const[e,t]=Object(a.useState)([]),[n,l]=Object(a.useState)(!0),c=r.a.createElement("div",{className:"loading",key:0}," ",r.a.createElement("span",{role:"img","aria-label":"loading"},"\ud83c\udf12")," ");return r.a.createElement("div",{className:"Home"},r.a.createElement(d.a,{pageStart:0,loadMore:function(n){fetch(f+"/meta?token="+E()+"&page="+n).then(e=>e.json()).then(n=>{t(e.concat(n.meta)),l(n.hasMore)})},hasMore:n,loader:c},r.a.createElement(b,{items:e})))};n(224);var g=function(){const[e,t]=Object(a.useState)(""),n=Object(s.g)();return Object(a.useEffect)(()=>{t(localStorage.nonsense_token||"")},[]),r.a.createElement("div",null,r.a.createElement("form",{onSubmit:function(t){t.preventDefault(),""!==e?(localStorage.nonsense_token=e,alert("Hello, "+e+"!")):(localStorage.nonsense_token="nonsense",alert("Hello, nonsense!")),n.push("/")},className:"login-form"},r.a.createElement("div",{className:"title"}," Make any sense ? "),r.a.createElement("input",{type:"text",value:e,placeholder:"nonsense",maxLength:"99",onChange:function(e){t(e.target.value)}})))},w=(n(225),n(690)),N=n(127),S=n(128),j=n(688),k=n(689),O=n(205),y=n(200),D=n(204),C=n(135),M=n(203),x=n(206),H=n(199),A=n(198),L=n(93),F=n(201);n(226);function P(e){const t=Object(j.b)(t=>w.a.make().config(n=>{n.set(N.d,t),n.set(S.b,e.content),n.set(C.b,{markdown:[e.onChange]})}).use(F.a).use(L.a).use(k.a).use(C.a).use(D.a).use(O.a).use(x.a).use(A.a).use(M.a).use(y.a).use(H.a),[]);return r.a.createElement(j.a,{className:"milk",editor:t})}var _=n(197),z=n.n(_);n(674),n(675),n(676),n(677);var I=function(){const[e,t]=Object(a.useState)(""),[n,l]=Object(a.useState)(0),[c,o]=Object(a.useState)(!0),[i,u]=Object(a.useState)("\ud83d\udfe2"),[m,d]=Object(a.useState)(1),[p,b]=Object(a.useState)("-1"),v=Object(a.useRef)(null),[g,w]=Object(a.useState)(0),N=Object(s.g)(),{nid:S}=Object(s.h)();function j(e){if("\ud83d\udd34"===i||"\ud83d\udfe0"===i||"\ud83d\udfe1"===i)return e.preventDefault(),e.returnValue="Draft unsaved"}function k(){if("\ud83d\udfe0"===i)if(u("\ud83d\udfe1"),"-1"===p){let t=new FormData;t.append("token",E()),t.append("body",e),t.append("state",m),fetch(f+"/post",{method:"POST",body:t}).then(e=>e.json()).catch(e=>{console.error("Post error: ",e),u("\ud83d\udd34")}).then(e=>{console.log(e),b(e.nid.toString()),u("\ud83d\udfe2")})}else{let t=new FormData;t.append("nid",p),t.append("body",e),t.append("state",m),fetch(f+"/update",{method:"POST",body:t}).then(e=>e.json()).catch(e=>{console.error("Update error: ",e),u("\ud83d\udd34")}).then(e=>{u("\ud83d\udfe2")})}}function O(e){e.preventDefault(),t(e.target.value),u("\ud83d\udfe0")}function y(e){t(e),u("\ud83d\udfe0")}function D(e){const n=e();t(n),u("\ud83d\udfe0")}function C(e,t){e.preventDefault(),d(t),u("\ud83d\udfe0")}function M(n){9===n.keyCode&&(n.preventDefault(),t(e.substring(0,v.current.selectionStart)+"    "+e.substring(v.current.selectionEnd)),w(v.current.selectionStart))}function x(e){return window.screen.width<=600?0===e?"R":1===e?"M":2===e?"A":"E":0===e?"Raw":1===e?"Milk":2===e?"Ace":"Error"}return Object(a.useEffect)(()=>{"-1"===S?(b(S),l(Date.now()/1e3),t(""),o(!1)):(b(S),fetch(f+"/get?nid="+S+"&token="+E()).then(e=>e.json()).then(e=>{e.success?(l(e.content[1]),t(e.content[2]),d(e.content[4]),o(!1)):(d(e.error),o(!1))}))},[S]),Object(a.useEffect)(()=>{const e=setInterval(k,1e3);return()=>{clearInterval(e)}}),Object(a.useEffect)(()=>(window.addEventListener("beforeunload",j),()=>{window.removeEventListener("beforeunload",j)})),Object(a.useEffect)(()=>{null!=v.current&&(v.current.selectionStart=g+4,v.current.selectionEnd=g+4)},[g]),c?r.a.createElement("div",{className:"loading"}," ",r.a.createElement("span",{role:"img","aria-label":"loading"},"\ud83c\udf12")," "):r.a.createElement("div",{className:"editor"},r.a.createElement("div",{className:"date"},"| ",r.a.createElement("span",null," ",h(n)," "),"| ",r.a.createElement("span",{onClick:e=>{C(e,0)},className:"button"}," ",x(0)," "),"| ",r.a.createElement("span",{onClick:e=>{C(e,1)},className:"button"}," ",x(1)," "),"| ",r.a.createElement("span",{onClick:e=>{C(e,2)},className:"button"}," ",x(2)," "),"| ",r.a.createElement("span",{onClick:function(e){if(e.preventDefault(),window.confirm("Are you sure to delete?")){let e=new FormData;e.append("nid",p),e.append("token",E()),fetch(f+"/delete",{method:"POST",body:e}).then(e=>e.json()).then(e=>{e.success?N.push("/"):alert(e.error)})}},className:"button",role:"img","aria-label":"delete"}," \u274c "),"| ",r.a.createElement("span",{onClick:function(e){e.preventDefault(),u("\ud83d\udfe0")},className:"button"}," ",function(e){return"\ud83d\udd34"===e?r.a.createElement("span",{role:"img","aria-label":"failed"}," \ud83d\udd34 "):"\ud83d\udfe2"===e?r.a.createElement("span",{role:"img","aria-label":"saved"}," \ud83d\udfe2 "):e}(i)," ")," |"),function(t){return 0===t?r.a.createElement("textarea",{ref:v,onKeyDown:M,onChange:O,value:e,style:{height:window.innerHeight-200}}):1===t?r.a.createElement(P,{content:e,onChange:D}):2===t?r.a.createElement(z.a,{mode:"markdown",theme:"github",name:"editor",value:e,onChange:y,height:(window.innerHeight-200).toString()+"px",width:"100%",showGutter:!(window.screen.width<=600),showPrintMargin:!1,highlightActiveLine:!0,placeholder:"",keyboardHandler:"vscode",fontSize:16,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!(window.screen.width<=600),tabSize:2,fontFamily:"Consolas,'Microsoft Yahei','Helvetica Neue', Helvetica, Arial, sans-serif"}}):t}(m),r.a.createElement(s.a,{message:"Draft unsaved, are you sure to leave?",when:"\ud83d\udd34"===i||"\ud83d\udfe0"===i||"\ud83d\udfe1"===i}))};var R=function(){const e=Object(s.g)(),[t,n]=Object(a.useState)("");return r.a.createElement("form",{onSubmit:function(a){a.preventDefault(),""!==t&&(e.push("/search/"+t),n(""))}},r.a.createElement("input",{type:"text",value:t,placeholder:"search",onChange:function(e){n(e.target.value)}}))};var T=function(){let{keyword:e}=Object(s.h)();const[t,n]=Object(a.useState)([]);return Object(a.useEffect)(()=>{fetch(f+"/search?keyword="+e+"&token="+E()).then(e=>e.json()).then(e=>{n(e)})},[e]),r.a.createElement("div",{className:"search-results"},r.a.createElement(b,{items:t}))};function B(){return r.a.createElement("div",{className:"no-match"},r.a.createElement("p",null," No match! "))}var J=function(){return r.a.createElement("div",{className:"App"},r.a.createElement(o.a,null,r.a.createElement("div",{className:"header"},r.a.createElement("div",{className:"title"}," ",r.a.createElement(o.b,{to:"/"}," N",r.a.createElement("span",{style:{fontSize:"20px"},role:"img","aria-label":"o"},"\ud83c\udf11"),"NSeNSe ")," "),r.a.createElement("div",{className:"new-button"}," ",r.a.createElement(o.b,{to:"/edit/-1"}," + ")," "),r.a.createElement("div",{className:"login-button"}," ",r.a.createElement(o.b,{to:"/login"}," \u2699 ")," "),r.a.createElement("div",{className:"search-bar"}," ",r.a.createElement(R,null)," ")),r.a.createElement("div",{className:"content"},r.a.createElement("hr",{className:"fancy-line"}),r.a.createElement(s.d,null,r.a.createElement(s.b,{exact:!0,path:"/login"},r.a.createElement(g,null)),r.a.createElement(s.b,{exact:!0,path:"/"},r.a.createElement(v,null)),r.a.createElement(s.b,{path:"/search/:keyword"},r.a.createElement(T,null)),r.a.createElement(s.b,{path:"/edit/:nid"},r.a.createElement(I,null)),r.a.createElement(s.b,{path:"*"},r.a.createElement(B,null))),r.a.createElement("hr",{className:"fancy-line"})),r.a.createElement(u.a,{showUnder:160},r.a.createElement("span",{className:"up-arrow",role:"img","aria-label":"up"}," \ud83c\udf20 "))))};c.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(J,null)),document.getElementById("root"))}},[[210,1,2]]]);
//# sourceMappingURL=main.9ec2fb4a.chunk.js.map