(this.webpackJsonpnonsense=this.webpackJsonpnonsense||[]).push([[0],{142:function(e,t,n){},218:function(e,t,n){},223:function(e,t,n){},227:function(e,t,n){},228:function(e,t,n){},229:function(e,t,n){},681:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n.n(s),a=n(98),r=n.n(a),o=(n(218),n(29)),i=n(18),l=n(190),j=n.n(l),u=(n(142),n(191)),d=n.n(u);const b=window.API_ROOT;n(223);function h(e){var t=new Date(1e3*e),n=t.getFullYear(),s=t.getMonth()+1,c=t.getDate(),a=t.getHours(),r=t.getMinutes();return n+"-"+s+"-"+c+" "+(a<=9?"0"+a:a)+":"+(r<=9?"0"+r:r)}function O(e,t){var n="000000000"+e.toString();return n.substr(n.length-t)}function f(){return localStorage.nonsense_token||"nonsense"}var x=n(3);function p(e){return Object(x.jsx)("div",{className:"flow-item",children:Object(x.jsxs)(o.b,{to:"/edit/"+e.value[0],children:[Object(x.jsxs)("div",{className:"date",children:[Object(x.jsxs)("span",{children:[" ",O(e.value[0],6)," "]}),Object(x.jsxs)("span",{children:[" "," "+h(e.value[2])," "]}),Object(x.jsxs)("span",{children:[" "," "+h(e.value[1])," "]})]}),Object(x.jsx)("hr",{}),Object(x.jsx)("div",{className:"content",children:(t=e.value[3],n=300,t.length>n?t.substring(0,n)+"......":t)})]})});var t,n}var m=function(e){return Object(x.jsx)("div",{className:"flow",children:e.items.map(((e,t)=>Object(x.jsx)(p,{value:e},t)))})};var v=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)(!0),a=Object(x.jsxs)("div",{className:"loading",children:[" ",Object(x.jsx)("span",{role:"img","aria-label":"loading",children:"\ud83c\udf12"})," "]},0);return Object(x.jsx)("div",{className:"Home",children:Object(x.jsx)(d.a,{pageStart:0,loadMore:function(n){fetch(b+"/meta?token="+f()+"&page="+n).then((e=>e.json())).then((n=>{t(e.concat(n.meta)),c(n.hasMore)}))},hasMore:n,loader:a,children:Object(x.jsx)(m,{items:e})})})};n(227);var g=function(){const[e,t]=Object(s.useState)(""),n=Object(i.g)();return Object(s.useEffect)((()=>{t(localStorage.nonsense_token||"")}),[]),Object(x.jsx)("div",{children:Object(x.jsxs)("form",{onSubmit:function(t){t.preventDefault(),""!==e?(localStorage.nonsense_token=e,alert("Hello, "+e+"!")):(localStorage.nonsense_token="nonsense",alert("Hello, nonsense!")),n.push("/")},className:"login-form",children:[Object(x.jsx)("div",{className:"title",children:" Make any sense ? "}),Object(x.jsx)("input",{type:"text",value:e,placeholder:"nonsense",maxLength:"99",onChange:function(e){t(e.target.value)}})]})})},w=(n(228),n(692)),N=n(132),S=n(133),k=n(691),y=n(211),D=n(209),C=n(205),E=n(208),M=n(139),A=n(130),H=n(210),L=n(204),P=n(203),F=n(97),_=n(206);n(229);function I(e){const t=Object(k.b)((t=>w.a.make().config((n=>{n.set(N.d,t),n.set(S.b,e.content),n.set(M.b,{markdown:[e.onChange]})})).use(_.a).use(F.a).use(y.a).use(M.a).use(E.a).use(D.a).use(H.a).use(P.a).use(A.a).use(C.a).use(L.a)),[]);return Object(x.jsx)(k.a,{className:"milk",editor:t})}var R=n(202),T=n.n(R);n(677),n(678),n(679),n(680);var z=function(){const[e,t]=Object(s.useState)(""),[n,c]=Object(s.useState)(0),[a,r]=Object(s.useState)(!0),[o,l]=Object(s.useState)("\ud83d\udfe2"),[j,u]=Object(s.useState)(1),[d,O]=Object(s.useState)("-1"),p=Object(s.useRef)(null),[m,v]=Object(s.useState)(0),g=Object(i.g)(),{nid:w}=Object(i.h)();function N(e){if("\ud83d\udd34"===o||"\ud83d\udfe0"===o||"\ud83d\udfe1"===o)return e.preventDefault(),e.returnValue="Draft unsaved"}function S(){if("\ud83d\udfe0"===o)if(l("\ud83d\udfe1"),"-1"===d){let t=new FormData;t.append("token",f()),t.append("body",e),t.append("state",j),fetch(b+"/post",{method:"POST",body:t}).then((e=>e.json())).catch((e=>{console.error("Post error: ",e),l("\ud83d\udd34")})).then((e=>{console.log(e),O(e.nid.toString()),l("\ud83d\udfe2")}))}else{let t=new FormData;t.append("nid",d),t.append("body",e),t.append("state",j),fetch(b+"/update",{method:"POST",body:t}).then((e=>e.json())).catch((e=>{console.error("Update error: ",e),l("\ud83d\udd34")})).then((e=>{l("\ud83d\udfe2")}))}}function k(e){e.preventDefault(),t(e.target.value),l("\ud83d\udfe0")}function y(e){t(e),l("\ud83d\udfe0")}function D(e){const n=e();t(n),l("\ud83d\udfe0")}function C(e,t){e.preventDefault(),u(t),l("\ud83d\udfe0")}function E(n){9===n.keyCode&&(n.preventDefault(),t(e.substring(0,p.current.selectionStart)+"    "+e.substring(p.current.selectionEnd)),v(p.current.selectionStart))}function M(e){return window.screen.width<=600?0===e?"R":1===e?"M":2===e?"A":"E":0===e?"Raw":1===e?"Milk":2===e?"Ace":"Error"}return Object(s.useEffect)((()=>{"-1"===w?(O(w),c(Date.now()/1e3),t(""),r(!1)):(O(w),fetch(b+"/get?nid="+w+"&token="+f()).then((e=>e.json())).then((e=>{e.success?(c(e.content[1]),t(e.content[2]),u(e.content[4]),r(!1)):(u(e.error),r(!1))})))}),[w]),Object(s.useEffect)((()=>{const e=setInterval(S,1e3);return()=>{clearInterval(e)}})),Object(s.useEffect)((()=>(window.addEventListener("beforeunload",N),()=>{window.removeEventListener("beforeunload",N)}))),Object(s.useEffect)((()=>{null!=p.current&&(p.current.selectionStart=m+4,p.current.selectionEnd=m+4)}),[m]),a?Object(x.jsxs)("div",{className:"loading",children:[" ",Object(x.jsx)("span",{role:"img","aria-label":"loading",children:"\ud83c\udf12"})," "]}):Object(x.jsxs)("div",{className:"editor",children:[Object(x.jsxs)("div",{className:"date",children:["| ",Object(x.jsxs)("span",{children:[" ",h(n)," "]}),"| ",Object(x.jsxs)("span",{onClick:e=>{C(e,0)},className:"button",children:[" ",M(0)," "]}),"| ",Object(x.jsxs)("span",{onClick:e=>{C(e,1)},className:"button",children:[" ",M(1)," "]}),"| ",Object(x.jsxs)("span",{onClick:e=>{C(e,2)},className:"button",children:[" ",M(2)," "]}),"| ",Object(x.jsx)("span",{onClick:function(e){if(e.preventDefault(),window.confirm("Are you sure to delete?")){let e=new FormData;e.append("nid",d),e.append("token",f()),fetch(b+"/delete",{method:"POST",body:e}).then((e=>e.json())).then((e=>{e.success?g.push("/"):alert(e.error)}))}},className:"button",role:"img","aria-label":"delete",children:" \u274c "}),"| ",Object(x.jsxs)("span",{onClick:function(e){e.preventDefault(),l("\ud83d\udfe0")},className:"button",children:[" ",function(e){return"\ud83d\udd34"===e?Object(x.jsx)("span",{role:"img","aria-label":"failed",children:" \ud83d\udd34 "}):"\ud83d\udfe2"===e?Object(x.jsx)("span",{role:"img","aria-label":"saved",children:" \ud83d\udfe2 "}):e}(o)," "]})," |"]}),function(t){return 0===t?Object(x.jsx)("textarea",{ref:p,onKeyDown:E,onChange:k,value:e,style:{height:window.innerHeight-200}}):1===t?Object(x.jsx)(I,{content:e,onChange:D}):2===t?Object(x.jsx)(T.a,{mode:"markdown",theme:"github",name:"editor",value:e,onChange:y,height:(window.innerHeight-200).toString()+"px",width:"100%",showGutter:!(window.screen.width<=600),showPrintMargin:!1,highlightActiveLine:!0,placeholder:"",keyboardHandler:"vscode",fontSize:16,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!(window.screen.width<=600),tabSize:2,fontFamily:"Consolas,'Microsoft Yahei','Helvetica Neue', Helvetica, Arial, sans-serif"}}):t}(j),Object(x.jsx)(i.a,{message:"Draft unsaved, are you sure to leave?",when:"\ud83d\udd34"===o||"\ud83d\udfe0"===o||"\ud83d\udfe1"===o})]})};var B=function(){const e=Object(i.g)(),[t,n]=Object(s.useState)("");return Object(x.jsx)("form",{onSubmit:function(s){s.preventDefault(),""!==t&&(e.push("/search/"+t),n(""))},children:Object(x.jsx)("input",{type:"text",value:t,placeholder:"search",onChange:function(e){n(e.target.value)}})})};var J=function(){let{keyword:e}=Object(i.h)();const[t,n]=Object(s.useState)([]);return Object(s.useEffect)((()=>{fetch(b+"/search?keyword="+e+"&token="+f()).then((e=>e.json())).then((e=>{n(e)}))}),[e]),Object(x.jsx)("div",{className:"search-results",children:Object(x.jsx)(m,{items:t})})};function U(){return Object(x.jsx)("div",{className:"no-match",children:Object(x.jsx)("p",{children:" No match! "})})}var Y=function(){return Object(x.jsx)("div",{className:"App",children:Object(x.jsxs)(o.a,{children:[Object(x.jsxs)("div",{className:"header",children:[Object(x.jsxs)("div",{className:"title",children:[" ",Object(x.jsxs)(o.b,{to:"/",children:[" N",Object(x.jsx)("span",{style:{fontSize:"20px"},role:"img","aria-label":"o",children:"\ud83c\udf11"}),"NSeNSe "]})," "]}),Object(x.jsxs)("div",{className:"new-button",children:[" ",Object(x.jsx)(o.b,{to:"/edit/-1",children:" + "})," "]}),Object(x.jsxs)("div",{className:"login-button",children:[" ",Object(x.jsx)(o.b,{to:"/login",children:" \u2699 "})," "]}),Object(x.jsxs)("div",{className:"search-bar",children:[" ",Object(x.jsx)(B,{})," "]})]}),Object(x.jsxs)("div",{className:"content",children:[Object(x.jsx)("hr",{className:"fancy-line"}),Object(x.jsxs)(i.d,{children:[Object(x.jsx)(i.b,{exact:!0,path:"/login",children:Object(x.jsx)(g,{})}),Object(x.jsx)(i.b,{exact:!0,path:"/",children:Object(x.jsx)(v,{})}),Object(x.jsx)(i.b,{path:"/search/:keyword",children:Object(x.jsx)(J,{})}),Object(x.jsx)(i.b,{path:"/edit/:nid",children:Object(x.jsx)(z,{})}),Object(x.jsx)(i.b,{path:"*",children:Object(x.jsx)(U,{})})]}),Object(x.jsx)("hr",{className:"fancy-line"})]}),Object(x.jsx)(j.a,{showUnder:160,children:Object(x.jsx)("span",{className:"up-arrow",role:"img","aria-label":"up",children:" \ud83c\udf20 "})})]})})};r.a.render(Object(x.jsx)(c.a.StrictMode,{children:Object(x.jsx)(Y,{})}),document.getElementById("root"))}},[[681,1,2]]]);
//# sourceMappingURL=main.dd97ec71.chunk.js.map