(this.webpackJsonpnonsense=this.webpackJsonpnonsense||[]).push([[0],{142:function(e,t,n){},218:function(e,t,n){},223:function(e,t,n){},227:function(e,t,n){},228:function(e,t,n){},229:function(e,t,n){},681:function(e,t,n){"use strict";n.r(t);var s=n(2),c=n.n(s),a=n(98),r=n.n(a),o=(n(218),n(29)),i=n(18),l=n(190),j=n.n(l),u=(n(142),n(191)),d=n.n(u);const b=window.API_ROOT;n(223);function h(e){var t=new Date(1e3*e),n=t.getFullYear(),s=t.getMonth()+1,c=t.getDate(),a=t.getHours(),r=t.getMinutes();return n+"-"+s+"-"+c+" "+(a<=9?"0"+a:a)+":"+(r<=9?"0"+r:r)}function O(e,t){var n="000000000"+e.toString();return n.substr(n.length-t)}function f(){return localStorage.nonsense_token||"nonsense"}var m=n(3);function x(e){return Object(m.jsx)("div",{className:"flow-item",children:Object(m.jsxs)(o.b,{to:"/edit/"+e.value[0],children:[Object(m.jsxs)("div",{className:"date",children:[Object(m.jsxs)("span",{children:[" ",O(e.value[0],6)," "]}),Object(m.jsxs)("span",{children:[" "," "+h(e.value[2])," "]}),Object(m.jsxs)("span",{children:[" "," "+h(e.value[1])," "]})]}),Object(m.jsx)("hr",{}),Object(m.jsx)("div",{className:"content",children:(t=e.value[3],n=300,t.length>n?t.substring(0,n)+"......":t)})]})});var t,n}var p=function(e){return Object(m.jsx)("div",{className:"flow",children:e.items.map(((e,t)=>Object(m.jsx)(x,{value:e},t)))})};var v=function(){const[e,t]=Object(s.useState)([]),[n,c]=Object(s.useState)(!0),a=Object(m.jsxs)("div",{className:"loading",children:[" ",Object(m.jsx)("span",{role:"img","aria-label":"loading",children:"\ud83c\udf12"})," "]},0);return Object(m.jsx)("div",{className:"Home",children:Object(m.jsx)(d.a,{pageStart:0,loadMore:function(n){fetch(b+"/meta?token="+f()+"&page="+n).then((e=>e.json())).then((n=>{t(e.concat(n.meta)),c(n.hasMore)}))},hasMore:n,loader:a,children:Object(m.jsx)(p,{items:e})})})};n(227);var g=function(){const[e,t]=Object(s.useState)(""),n=Object(i.g)();return Object(s.useEffect)((()=>{t(localStorage.nonsense_token||"")}),[]),Object(m.jsx)("div",{children:Object(m.jsxs)("form",{onSubmit:function(s){s.preventDefault(),""===e&&t("nonsense"),e.length>100?alert("Channel name too long!"):/^[0-9a-zA-Z_.-]+$/.test(e)?(localStorage.nonsense_token=e,alert("Hello, "+e+"!"),n.push("/")):alert("Channel name contains invalid characters! Only [0-9a-zA-Z_.-] are allowed.")},className:"login-form",children:[Object(m.jsx)("div",{className:"title",children:" Make any sense ? "}),Object(m.jsx)("input",{type:"text",value:e,placeholder:"nonsense",maxLength:"99",onChange:function(e){t(e.target.value)}})]})})},N=(n(228),n(692)),w=n(132),S=n(133),k=n(691),y=n(211),D=n(209),C=n(205),E=n(208),M=n(139),A=n(130),H=n(210),L=n(204),P=n(203),_=n(97),z=n(206);n(229);function F(e){const t=Object(k.b)((t=>N.a.make().config((n=>{n.set(w.d,t),n.set(S.b,e.content),n.set(M.b,{markdown:[e.onChange]})})).use(z.a).use(_.a).use(y.a).use(M.a).use(E.a).use(D.a).use(H.a).use(P.a).use(A.a).use(C.a).use(L.a)),[]);return Object(m.jsx)(k.a,{className:"milk",editor:t})}var I=n(202),R=n.n(I);n(677),n(678),n(679),n(680);var T=function(){const[e,t]=Object(s.useState)(""),[n,c]=Object(s.useState)(0),[a,r]=Object(s.useState)(!0),[o,l]=Object(s.useState)("\ud83d\udfe2"),[j,u]=Object(s.useState)(1),[d,O]=Object(s.useState)("-1"),x=Object(s.useRef)(null),[p,v]=Object(s.useState)(0),g=Object(i.g)(),{nid:N}=Object(i.h)();function w(e){e.preventDefault(),t(e.target.value),l("\ud83d\udfe0")}function S(e){t(e),l("\ud83d\udfe0")}function k(e){const n=e();t(n),l("\ud83d\udfe0")}function y(e,t){e.preventDefault(),u(t),l("\ud83d\udfe0")}function D(n){9===n.keyCode&&(n.preventDefault(),t(e.substring(0,x.current.selectionStart)+"    "+e.substring(x.current.selectionEnd)),v(x.current.selectionStart))}function C(e){return window.screen.width<=600?0===e?"R":1===e?"M":2===e?"A":"E":0===e?"Raw":1===e?"Milk":2===e?"Ace":"Error"}return Object(s.useEffect)((()=>("-1"===N?(O(N),c(Date.now()/1e3),t(""),document.title="NoNSeNSe",r(!1)):(O(N),fetch(b+"/get?nid="+N+"&token="+f()).then((e=>e.json())).then((e=>{e.success?(c(e.content[1]),t(e.content[2]),u(e.content[4]),document.title="NoNSeNSe | "+e.content[2].substring(0,20),r(!1)):(u(e.error),r(!1))}))),()=>{document.title="NoNSeNSe"})),[N]),Object(s.useEffect)((()=>{const t=setInterval((function(){if("\ud83d\udfe0"===o)if(l("\ud83d\udfe1"),"-1"===d){let t=new FormData;t.append("token",f()),t.append("body",e),t.append("state",j),fetch(b+"/post",{method:"POST",body:t}).then((e=>e.json())).catch((e=>{console.error("Post error: ",e),l("\ud83d\udd34")})).then((e=>{console.log(e),O(e.nid.toString()),l("\ud83d\udfe2")}))}else{let t=new FormData;t.append("nid",d),t.append("body",e),t.append("state",j),fetch(b+"/update",{method:"POST",body:t}).then((e=>e.json())).catch((e=>{console.error("Update error: ",e),l("\ud83d\udd34")})).then((e=>{l("\ud83d\udfe2")}))}}),1e3);return()=>{clearInterval(t)}})),Object(s.useEffect)((()=>{function e(e){if("\ud83d\udd34"===o||"\ud83d\udfe0"===o||"\ud83d\udfe1"===o)return e.preventDefault(),e.returnValue="Draft unsaved"}return window.addEventListener("beforeunload",e),()=>{window.removeEventListener("beforeunload",e)}}),[o]),Object(s.useEffect)((()=>{null!=x.current&&(x.current.selectionStart=p+4,x.current.selectionEnd=p+4)}),[p]),a?Object(m.jsxs)("div",{className:"loading",children:[" ",Object(m.jsx)("span",{role:"img","aria-label":"loading",children:"\ud83c\udf12"})," "]}):Object(m.jsxs)("div",{className:"editor",children:[Object(m.jsxs)("div",{className:"date",children:["| ",Object(m.jsxs)("span",{children:[" ",h(n)," "]}),"| ",Object(m.jsxs)("span",{onClick:e=>{y(e,0)},className:"button",children:[" ",C(0)," "]}),"| ",Object(m.jsxs)("span",{onClick:e=>{y(e,1)},className:"button",children:[" ",C(1)," "]}),"| ",Object(m.jsxs)("span",{onClick:e=>{y(e,2)},className:"button",children:[" ",C(2)," "]}),"| ",Object(m.jsx)("span",{onClick:function(e){if(e.preventDefault(),window.confirm("Are you sure to delete?")){let e=new FormData;e.append("nid",d),e.append("token",f()),fetch(b+"/delete",{method:"POST",body:e}).then((e=>e.json())).then((e=>{e.success?(document.title="NoNSeNSe",g.push("/")):alert(e.error)}))}},className:"button",role:"img","aria-label":"delete",children:" \u274c "}),"| ",Object(m.jsxs)("span",{onClick:function(e){e.preventDefault(),l("\ud83d\udfe0")},className:"button",children:[" ",function(e){return"\ud83d\udd34"===e?Object(m.jsx)("span",{role:"img","aria-label":"failed",children:" \ud83d\udd34 "}):"\ud83d\udfe2"===e?Object(m.jsx)("span",{role:"img","aria-label":"saved",children:" \ud83d\udfe2 "}):e}(o)," "]})," |"]}),function(t){return 0===t?Object(m.jsx)("textarea",{ref:x,onKeyDown:D,onChange:w,value:e,style:{height:window.innerHeight-200}}):1===t?Object(m.jsx)(F,{content:e,onChange:k}):2===t?Object(m.jsx)(R.a,{mode:"markdown",theme:"github",name:"editor",value:e,onChange:S,height:(window.innerHeight-200).toString()+"px",width:"100%",showGutter:!(window.screen.width<=600),showPrintMargin:!1,highlightActiveLine:!0,placeholder:"",keyboardHandler:"vscode",fontSize:16,setOptions:{enableBasicAutocompletion:!0,enableLiveAutocompletion:!0,enableSnippets:!1,showLineNumbers:!(window.screen.width<=600),tabSize:2,fontFamily:"Consolas,'Microsoft Yahei','Helvetica Neue', Helvetica, Arial, sans-serif"}}):t}(j),Object(m.jsx)(i.a,{message:"Draft unsaved, are you sure to leave?",when:"\ud83d\udd34"===o||"\ud83d\udfe0"===o||"\ud83d\udfe1"===o})]})};var B=function(){const e=Object(i.g)(),[t,n]=Object(s.useState)("");return Object(m.jsx)("form",{onSubmit:function(s){s.preventDefault(),""!==t&&(e.push("/search/"+t),n(""))},children:Object(m.jsx)("input",{type:"text",value:t,placeholder:"search",onChange:function(e){n(e.target.value)}})})};var J=function(){let{keyword:e}=Object(i.h)();const[t,n]=Object(s.useState)([]);return Object(s.useEffect)((()=>{fetch(b+"/search?keyword="+e+"&token="+f()).then((e=>e.json())).then((e=>{n(e)}))}),[e]),Object(m.jsx)("div",{className:"search-results",children:Object(m.jsx)(p,{items:t})})};function U(){return Object(m.jsx)("div",{className:"no-match",children:Object(m.jsx)("p",{children:" No match! "})})}var Y=function(){const e=["\ud83d\udc97","\ud83d\udda4","\ud83d\udc94","\ud83e\udde1","\ud83d\udc9b","\ud83d\udc9a","\ud83d\udc99","\ud83d\udc9c","\ud83e\udd0e","\ud83e\udd0d","\ud83d\udcab","\ud83d\udd73","\ud83c\udf38","\ud83c\udf40","\ud83c\udf41","\ud83d\udc1a","\ud83d\udc1e","\ud83e\udd5d","\ud83c\udf49","\ud83c\udf4a","\ud83e\udd65","\ud83c\udf44","\ud83c\udf69","\ud83c\udf6d","\ud83c\udf82","\ud83c\udf6c","\ud83c\udf65","\ud83c\udf6a","\ud83e\uddca","\ud83c\udf0d","\ud83c\udf0e","\ud83c\udf0f","\ud83e\udded","\ud83c\udf05","\ud83c\udfa1","\ud83c\udf11","\ud83c\udf15","\ud83e\ude90","\ud83c\udf0c","\ud83c\udf83","\ud83c\udf86","\ud83c\udfa8","\ud83d\udcbf","\ud83d\udcc0","\ud83c\udfee","\ud83e\uddeb","\ud83d\udc8a","\ud83e\ude78","\ud83d\udca0"];return Object(m.jsx)("div",{className:"App",children:Object(m.jsxs)(o.a,{children:[Object(m.jsxs)("div",{className:"header",children:[Object(m.jsxs)("div",{className:"title",children:[" ",Object(m.jsxs)(o.b,{to:"/",children:[" ",function(){const t=e[Math.floor(Math.random()*e.length)];return Object(m.jsxs)("div",{children:["N",Object(m.jsx)("span",{style:{fontSize:"20px"},role:"img","aria-label":"o",children:t}),"NSeNSe"]})}()," "]})," "]}),Object(m.jsxs)("div",{className:"new-button",children:[" ",Object(m.jsx)(o.b,{to:"/edit/-1",children:" + "})," "]}),Object(m.jsxs)("div",{className:"login-button",children:[" ",Object(m.jsx)(o.b,{to:"/login",children:" \u2699 "})," "]}),Object(m.jsxs)("div",{className:"search-bar",children:[" ",Object(m.jsx)(B,{})," "]})]}),Object(m.jsxs)("div",{className:"content",children:[Object(m.jsx)("hr",{className:"fancy-line"}),Object(m.jsxs)(i.d,{children:[Object(m.jsx)(i.b,{exact:!0,path:"/login",children:Object(m.jsx)(g,{})}),Object(m.jsx)(i.b,{exact:!0,path:"/",children:Object(m.jsx)(v,{})}),Object(m.jsx)(i.b,{path:"/search/:keyword",children:Object(m.jsx)(J,{})}),Object(m.jsx)(i.b,{path:"/edit/:nid",children:Object(m.jsx)(T,{})}),Object(m.jsx)(i.b,{path:"*",children:Object(m.jsx)(U,{})})]}),Object(m.jsx)("hr",{className:"fancy-line"})]}),Object(m.jsx)(j.a,{showUnder:160,children:Object(m.jsx)("span",{className:"up-arrow",role:"img","aria-label":"up",children:" \ud83c\udf20 "})})]})})};r.a.render(Object(m.jsx)(c.a.StrictMode,{children:Object(m.jsx)(Y,{})}),document.getElementById("root"))}},[[681,1,2]]]);
//# sourceMappingURL=main.ebbcb8d4.chunk.js.map